<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Key Management - GPyG Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Key Management";
        var mkdocs_page_input_path = "usage/key_management.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> GPyG Documentation
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Usage</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Key Management</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#key-generation">Key Generation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#retrieving-keys">Retrieving Keys</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#importing-keys">Importing Keys</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#working-with-keys">Working With Keys</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#reloading-key-info">Reloading Key Info</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exporting-keys">Exporting Keys</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#verifying-passphrase">Verifying Passphrase</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#signing-other-keys">Signing Other Keys</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#accessing-subkeys">Accessing Subkeys</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#deleting-keys">Deleting Keys</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../message_management/">Message Management</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../card_management/">Smart Card Management</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/gpg-instance/">GPG Instance</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Operators</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../api/operators/keys/">Key Operations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../api/operators/messages/">Message Operations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../api/operators/cards/">SmartCard Operations</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Models & Types</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../api/models/cards/">SmartCard Types</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../api/models/keys/">Key Types</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../api/models/other/">Other Types</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">GPyG Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Usage</li>
      <li class="breadcrumb-item active">Key Management</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="key-management">Key Management</h1>
<p><em>Operations related to managing your keys.</em></p>
<hr />
<p>All key operations are performed under either an instance of <code>KeyOperator</code> returned by <code>GPG.keys</code> for non-key-specific operations, or an instance of <code>Key</code> for operations specific to a single key.</p>
<h2 id="key-generation">Key Generation</h2>
<p>To generate a key on the host system, the <code>KeyOperator.generate_key(...)</code> method is used as follows:</p>
<pre><code class="language-python"># Generates a key with the UID &quot;My Name&quot; and all other parameters as default. No passphrase is specified.
new_key = gpg.keys.generate_key(&quot;My Name&quot;)

# Generates a key with a full UID and a passphrase.
new_key = gpg.keys.generate_key(&quot;My Name&quot;, email=&quot;my@email.com&quot;, comment=&quot;My really cool key&quot;, passphrase=&quot;secure-password&quot;)

# Generates a key with a name-only UID and an expiration date
new_key = gpg.keys.generate_key(&quot;My Name&quot;, expiration=datetime.datetime(1, 2, 2026))

# Generates a key with a name and passphrase, even if a key with that UID already exists.
new_key = gpg.keys.generate_key(&quot;My Name&quot;, passphrase=&quot;secure-password&quot;, force=True)
</code></pre>
<p>For further information, see <a href="../../api/operators/keys/#key-operator"><code>KeyOperator</code></a>.</p>
<h2 id="retrieving-keys">Retrieving Keys</h2>
<p>Keys can either be retrieved individually by fingerprint, or in aggregate based on a provided pattern.</p>
<pre><code class="language-python"># Get a list of all public keys
keys = gpg.keys.list_keys(key_type=&quot;public&quot;)

# Get a list of all private keys matching the string &quot;Alice&quot;
keys = gpg.keys.list_keys(pattern=&quot;Alice&quot;, key_type=&quot;secret&quot;)

# Get the public key of the key with fingerprint &quot;fake-fpr&quot;
# If the key doesn't exist, this will return None.
keys = gpg.keys.get_key(&quot;fake-fpr&quot;)
</code></pre>
<p>Along with <code>KeyOperator.generate_key(...)</code>, the above methods all return instances of <a href="../../api/operators/keys/#key---key-wrapper"><code>Key</code></a>, which wraps <a href="../../api/models/keys/#key-model"><code>KeyModel</code></a>.</p>
<h2 id="importing-keys">Importing Keys</h2>
<p>Keys can be imported from files as follows:</p>
<pre><code class="language-python">gpg.keys.import_key(&quot;file_1.asc&quot;, &quot;file_2.asc&quot;, ...)
</code></pre>
<p><code>import_key(...)</code> can import any number of keys from files, which can then be retrieved as shown in <a href="#retrieving-keys">Retrieving Keys</a>.</p>
<h2 id="working-with-keys">Working With Keys</h2>
<p>A full listing of all <code>Key</code> functions can be found <a href="../../api/operators/keys/#key---key-wrapper">here</a>, however some common operations are as follows:</p>
<h4 id="reloading-key-info">Reloading Key Info</h4>
<p>Allows for reloading the data of an existing <code>Key</code> object without recreating it.</p>
<pre><code class="language-python">key.reload() # Updates internal state &amp; returns the updated model for operation chaining.
</code></pre>
<h4 id="exporting-keys">Exporting Keys</h4>
<p>Exports a key's data into <code>bytes</code> which may then be written to a file or otherwise processed.</p>
<pre><code class="language-python"># Exports a key as ascii
as_ascii = key.export()

# Exports a private key as PGP binary
as_pgp = private_key.export(mode=&quot;gpg&quot;)
</code></pre>
<p>A number of other options can be passed to <code>export(...)</code>, and are summarized in the API documentation.</p>
<h4 id="verifying-passphrase">Verifying Passphrase</h4>
<p>Allows the verification of a passphrase (or verifying if the key is protected at all).</p>
<pre><code class="language-python"># Whether the key has a passphrase
is_protected = key.is_protected()

# Whether the given password is correct (if the key is unprotected, this will always return True)
is_valid = key.check_password(&quot;my-password&quot;)
</code></pre>
<h4 id="signing-other-keys">Signing Other Keys</h4>
<p>Allows signing other keys with the current key.</p>
<pre><code class="language-python"># Signs `other_key` with `key`, assuming key's password is &quot;my-password&quot;.
key.sign_key(other_key, password=&quot;my-password&quot;)
</code></pre>
<h4 id="accessing-subkeys">Accessing Subkeys</h4>
<p>Subkeys are stored under <code>Key.subkeys</code>, and are wrapped with similar functionality to <code>Key</code>. This allows deletion and/or modification of individual subkeys, similar to how one would do so for the primary key.</p>
<h4 id="deleting-keys">Deleting Keys</h4>
<p>Keys &amp; subkeys can delete themselves with the <code>Key.delete()</code> method, as follows:</p>
<pre><code class="language-python">key.delete() # Delete both the public and private key associated with `key`.

key.delete(delete_both=False) # Only delete the current key (ie, if the key is a public key, do NOT delete the secret key as well.)
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../getting_started/" class="btn btn-neutral float-left" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../message_management/" class="btn btn-neutral float-right" title="Message Management">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../getting_started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../message_management/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
